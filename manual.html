<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>manual</title><link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; tab-size: 4; background-position: inherit inherit; background-repeat: inherit inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 40px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; }
button, input, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 2; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.701961); color: rgb(85, 85, 85); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror-linenumber { }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit inherit; background-repeat: inherit inherit; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; background-position: 0px 0px; background-repeat: initial initial; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print { 
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 32px; padding-right: 32px; padding-bottom: 0px; break-after: avoid; }
  .typora-export #write::after { height: 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; overflow-x: hidden; background-position: initial initial; background-repeat: initial initial; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background-color: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; background-position: initial initial; background-repeat: initial initial; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; }
a.md-print-anchor { white-space: pre !important; border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; text-shadow: initial !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="mermaid"] svg, [lang="flow"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-scroll { overflow-y: hidden; overflow-x: auto; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; white-space: nowrap; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; border: none !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; border-width: 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; background-position: 0px 0px; background-repeat: initial initial; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-style: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-style: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background-color: rgba(255, 255, 0, 0.4); background-position: initial initial; background-repeat: initial initial; }
@media print { 
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

html {
    font-size: 16px;
}

body {
    font-family: "Open Sans","Clear Sans","Helvetica Neue",Helvetica,Arial,sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}
#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    padding-bottom: .3em;
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
   padding-bottom: .3em;
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}
h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table tr th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table tr td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table tr th:first-child,
table tr td:first-child {
    margin-top: 0;
}
table tr th:last-child,
table tr td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

 .typora-export li, .typora-export p, .typora-export,  .footnote-line {white-space: normal;} 
</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-mac'><h1><a name="ear-system----user-manual-and-datasets-beta-version" class="md-header-anchor"></a><span>EAR System -- User Manual and Datasets (Beta Version)</span></h1><p><span>This is the Beta version of our User Manual and Datasets.</span></p><p><span>Feel free to contact Yisong if you have any questions to use our system. (miaoyisong [AT] gmail.com)</span></p><p><span>This is possibly the first open-source system for conversational recommendation in recent years.</span></p><p><span>Wish you find it helpful! 😛</span></p><p>&nbsp;</p><p>&nbsp;</p><p><span>Please cite our paper if you use our codes or dataset.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">@inproceedings{lei2020estimation,</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  title={Estimation-Action-Reflection: Towards Deep Interaction Between Conversational and Recommender Systems},</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  author={Lei, Wenqiang and He, Xiangnan and Miao, Yisong and Wu, Qingyun and Hong, Richang and Kan, Min-Yen and Chua, Tat-Seng},</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  booktitle={Proceedings of the 13th International Conference on Web Search and Data Mining},</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  pages={304--312},</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  year={2020}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 220px;"></div><div class="CodeMirror-gutters" style="display: none; height: 220px;"></div></div></div></pre><hr /><p>&nbsp;</p><p><strong><span>Table of Content:</span></strong></p><div class='md-toc' mdtype='toc'><p class="md-toc-content"><span class="md-toc-item md-toc-h1" data-ref="n0"><a class="md-toc-inner" style="" href="#ear-system----user-manual-and-datasets-beta-version">EAR System -- User Manual and Datasets (Beta Version)</a></span><span class="md-toc-item md-toc-h2" data-ref="n15"><a class="md-toc-inner" style="" href="#1-system-overview">1. System Overview</a></span><span class="md-toc-item md-toc-h3" data-ref="n25"><a class="md-toc-inner" style="" href="#11-dependencies">1.1 Dependencies</a></span><span class="md-toc-item md-toc-h2" data-ref="n38"><a class="md-toc-inner" style="" href="#2-datasets">2. Datasets</a></span><span class="md-toc-item md-toc-h2" data-ref="n44"><a class="md-toc-inner" style="" href="#3-estimation-stage-----factorization-machine-model">3. Estimation Stage --  Factorization Machine Model</a></span><span class="md-toc-item md-toc-h2" data-ref="n52"><a class="md-toc-inner" style="" href="#4-action-stage--reflection-stage----user-simulator">4. Action Stage &amp; Reflection Stage -- User Simulator</a></span><span class="md-toc-item md-toc-h3" data-ref="n57"><a class="md-toc-inner" style="" href="#41-action-stage-training-and-evaluation">4.1 Action Stage Training and Evaluation</a></span><span class="md-toc-item md-toc-h3" data-ref="n64"><a class="md-toc-inner" style="" href="#42-ablation-study">4.2 Ablation Study</a></span><span class="md-toc-item md-toc-h3" data-ref="n74"><a class="md-toc-inner" style="" href="#43-baselines">4.3 Baselines</a></span><span class="md-toc-item md-toc-h2" data-ref="n91"><a class="md-toc-inner" style="" href="#5-licence-and-patent">5. Licence and Patent</a></span></p></div><p>&nbsp;</p><h2><a name="1-system-overview" class="md-header-anchor"></a><span>1. System Overview</span></h2><p><strong><span>TODO: Yisong: Need to draw an overview figure of our system here.</span></strong><span> </span></p><p><span>This system is developed in Python and PyTorch.  It is composed of two components: </span></p><ul><li><span>Recommender Component: </span><code>lib/FM</code></li><li><span>Conversation Component: </span><code>lib/user-simulator</code></li></ul><p><span>Note: Due to different settings in Yelp (enumerated questions) and LastFM (binary questions), their codes are stored in different directory with minor differences. However, the command lines below can be used interchangeably.</span></p><p>&nbsp;</p><h3><a name="11-dependencies" class="md-header-anchor"></a><span>1.1 Dependencies</span></h3><ul><li><span>First Download our code:</span></li></ul><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded md-focus" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap CodeMirror-focused" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 109px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">wget https://yisong.me/publications/EAR.zip</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><ul><li><span>Anaconda3 packages (</span><a href='https://www.digitalocean.com/community/tutorials/how-to-install-anaconda-on-ubuntu-18-04-quickstart' target='_blank' class='url'>https://www.digitalocean.com/community/tutorials/how-to-install-anaconda-on-ubuntu-18-04-quickstart</a><span>)</span></li><li><span>PyTorch == 1.3.1+cu92</span></li></ul><p><span>Run following codes to have a quick check if you have all packages ready.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">First clone EAR to your root directory</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cd</span> ~/EAR</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">python package-check.py </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 110px;"></div><div class="CodeMirror-gutters" style="display: none; height: 110px;"></div></div></div></pre><p>&nbsp;</p><h2><a name="2-datasets" class="md-header-anchor"></a><span>2. Datasets</span></h2><p><span>We currently put our data on Google Drive, please contact Yisong if you can&#39;t download it ( miaoyisong [AT] gmail.com).</span></p><p><span>Link:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">https://drive.google.com/open?id=13WcWe9JthbiSjcGeCWSTB6Ir7O6riiYy</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p>&nbsp;</p><p>&nbsp;</p><h2><a name="3-estimation-stage-----factorization-machine-model" class="md-header-anchor"></a><span>3. Estimation Stage --  Factorization Machine Model</span></h2><p><span>All Functions of our FM model can be realized by changing the parameter in </span><code>FM_old_train.py</code><span> as shown below:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span> = <span class="cm-variable">argparse</span>.<span class="cm-property">ArgumentParser</span>(<span class="cm-variable">description</span>=<span class="cm-string">"Run FM"</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-lr'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;lr&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'lr'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'lr'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-flr'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;flr&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'flr'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'flr'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># means the learning rate of feature similarity learning</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-reg'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;reg&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'reg'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'reg'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># regularization</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-decay'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;decay&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'decay'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'decay'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># weight decay</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-qonly'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;qonly&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'qonly'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'qonly'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># means quadratic form only (letting go other terms in FM equation...)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-bs'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;bs&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'bs'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'bs'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># batch size</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-hs'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;hs&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'hs'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'hs'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># hidden size</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-ip'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;ip&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'ip'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'ip'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># init parameter for hidden</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-dr'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;dr&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'dr'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'dr'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># dropout ratio</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-optim'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;optim&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'optim'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'optim'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># optimizer</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-observe'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;observe&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'observe'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'observe'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># the frequency of doing evaluation</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-oldnew'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;oldnew&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'oldnew'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'oldnew'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># we don't use this parameter now</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-pretrain'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;pretrain&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'pretrain'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'pretrain'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># does it need to load pretrain model?</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-uf'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;uf&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'uf'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'uf'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># update feature</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-rd'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;rd&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'rd'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'rd'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># remove duplicate, we don;t use this parameter now</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-useremb'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;useremb&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'useremb'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'user embedding'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># update user embedding during feature similarity</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-freeze'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;freeze&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'freeze'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'freeze'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># we don't use this param now</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-command'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;command&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'command'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'command'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># command = 6: normal FM</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># command = 8: with our second type of negative sample</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-seed'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">metavar</span>=<span class="cm-string">'&lt;seed&gt;'</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'seed'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'seed'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># random seed</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">A</span> = <span class="cm-variable">parser</span>.<span class="cm-property">parse_args</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1012px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1012px;"></div></div></div></pre><p>&nbsp;</p><p><span>The code to run experiment:</span></p><p>&nbsp;</p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Yelp has the slightly better overall performance with Adagrad Optimizer</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># LastFM would be better with SGD.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># The differences are minor.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cd</span> ~/EAR/yelp/lib/FM</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#FM (basic FM)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">0</span> python FM_old_train.py <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-flr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-reg</span> <span class="cm-number">0</span>.002 <span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-qonly</span> <span class="cm-number">1</span> <span class="cm-attribute">-bs</span> <span class="cm-number">64</span> <span class="cm-attribute">-hs</span> <span class="cm-number">64</span> <span class="cm-attribute">-ip</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-dr</span> <span class="cm-number">0</span>.5 <span class="cm-attribute">-optim</span> Ada <span class="cm-attribute">-observe</span> <span class="cm-number">1</span> <span class="cm-attribute">-oldnew</span> new <span class="cm-attribute">-pretrain</span> <span class="cm-number">0</span> <span class="cm-attribute">-rd</span> <span class="cm-number">0</span> <span class="cm-attribute">-uf</span> <span class="cm-number">0</span> <span class="cm-attribute">-freeze</span> <span class="cm-number">0</span> <span class="cm-attribute">-command</span> <span class="cm-number">6</span> <span class="cm-attribute">-useremb</span> <span class="cm-number">1</span> <span class="cm-attribute">-seed</span> <span class="cm-number">330</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#FM+A (FM and attribute aware BPR)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">1</span> python FM_old_train.py <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-flr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-reg</span> <span class="cm-number">0</span>.002 <span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-qonly</span> <span class="cm-number">1</span> <span class="cm-attribute">-bs</span> <span class="cm-number">64</span> <span class="cm-attribute">-hs</span> <span class="cm-number">64</span> <span class="cm-attribute">-ip</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-dr</span> <span class="cm-number">0</span>.5 <span class="cm-attribute">-optim</span> Ada <span class="cm-attribute">-observe</span> <span class="cm-number">1</span> <span class="cm-attribute">-oldnew</span> new <span class="cm-attribute">-pretrain</span> <span class="cm-number">0</span> <span class="cm-attribute">-rd</span> <span class="cm-number">0</span> <span class="cm-attribute">-uf</span> <span class="cm-number">0</span> <span class="cm-attribute">-freeze</span> <span class="cm-number">0</span> <span class="cm-attribute">-command</span> <span class="cm-number">8</span> <span class="cm-attribute">-useremb</span> <span class="cm-number">1</span> <span class="cm-attribute">-seed</span> <span class="cm-number">330</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#FM+A+T (multi-task training for item recommendation and attribute prediction)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">python FM_old_train.py <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-flr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-reg</span> <span class="cm-number">0</span>.002 <span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-qonly</span> <span class="cm-number">1</span> <span class="cm-attribute">-bs</span> <span class="cm-number">64</span> <span class="cm-attribute">-hs</span> <span class="cm-number">64</span> <span class="cm-attribute">-ip</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-dr</span> <span class="cm-number">0</span>.5 <span class="cm-attribute">-optim</span> Ada <span class="cm-attribute">-observe</span> <span class="cm-number">1</span> <span class="cm-attribute">-oldnew</span> new <span class="cm-attribute">-pretrain</span> <span class="cm-number">2</span> <span class="cm-attribute">-rd</span> <span class="cm-number">0</span> <span class="cm-attribute">-uf</span> <span class="cm-number">1</span> <span class="cm-attribute">-freeze</span> <span class="cm-number">0</span> <span class="cm-attribute">-command</span> <span class="cm-number">8</span> <span class="cm-attribute">-useremb</span> <span class="cm-number">1</span> <span class="cm-attribute">-seed</span> <span class="cm-number">330</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-attribute">-----------------------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cd</span> ~/EAR/lastfm/lib/FM</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#FM</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">2</span> python FM_old_train.py <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-flr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-reg</span> <span class="cm-number">0</span>.002 <span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-qonly</span> <span class="cm-number">1</span> <span class="cm-attribute">-bs</span> <span class="cm-number">64</span> <span class="cm-attribute">-hs</span> <span class="cm-number">64</span> <span class="cm-attribute">-ip</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-dr</span> <span class="cm-number">0</span>.5 <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-observe</span> <span class="cm-number">10</span> <span class="cm-attribute">-oldnew</span> new <span class="cm-attribute">-pretrain</span> <span class="cm-number">0</span> <span class="cm-attribute">-rd</span> <span class="cm-number">0</span> <span class="cm-attribute">-uf</span> <span class="cm-number">0</span> <span class="cm-attribute">-freeze</span> <span class="cm-number">0</span> <span class="cm-attribute">-command</span> <span class="cm-number">6</span> <span class="cm-attribute">-useremb</span> <span class="cm-number">1</span> <span class="cm-attribute">-seed</span> <span class="cm-number">330</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#FM + A</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">2</span> python FM_old_train.py <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-flr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-reg</span> <span class="cm-number">0</span>.002 <span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-qonly</span> <span class="cm-number">1</span> <span class="cm-attribute">-bs</span> <span class="cm-number">64</span> <span class="cm-attribute">-hs</span> <span class="cm-number">64</span> <span class="cm-attribute">-ip</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-dr</span> <span class="cm-number">0</span>.5 <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-observe</span> <span class="cm-number">10</span> <span class="cm-attribute">-oldnew</span> new <span class="cm-attribute">-pretrain</span> <span class="cm-number">0</span> <span class="cm-attribute">-rd</span> <span class="cm-number">0</span> <span class="cm-attribute">-uf</span> <span class="cm-number">0</span> <span class="cm-attribute">-freeze</span> <span class="cm-number">0</span> <span class="cm-attribute">-command</span> <span class="cm-number">8</span> <span class="cm-attribute">-useremb</span> <span class="cm-number">1</span> <span class="cm-attribute">-seed</span> <span class="cm-number">330</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#FM + A + MT</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">python FM_old_train.py <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-flr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-reg</span> <span class="cm-number">0</span>.002 <span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-qonly</span> <span class="cm-number">1</span> <span class="cm-attribute">-bs</span> <span class="cm-number">64</span> <span class="cm-attribute">-hs</span> <span class="cm-number">64</span> <span class="cm-attribute">-ip</span> <span class="cm-number">0</span>.01 <span class="cm-attribute">-dr</span> <span class="cm-number">0</span>.5 <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-observe</span> <span class="cm-number">1</span> <span class="cm-attribute">-oldnew</span> new <span class="cm-attribute">-pretrain</span> <span class="cm-number">2</span> <span class="cm-attribute">-rd</span> <span class="cm-number">0</span> <span class="cm-attribute">-uf</span> <span class="cm-number">1</span> <span class="cm-attribute">-freeze</span> <span class="cm-number">0</span> <span class="cm-attribute">-command</span> <span class="cm-number">8</span> <span class="cm-attribute">-useremb</span> <span class="cm-number">1</span> <span class="cm-attribute">-seed</span> <span class="cm-number">330</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 836px;"></div><div class="CodeMirror-gutters" style="display: none; height: 836px;"></div></div></div></pre><p>&nbsp;</p><h2><a name="4-action-stage--reflection-stage----user-simulator" class="md-header-anchor"></a><span>4. Action Stage &amp; Reflection Stage -- User Simulator</span></h2><p><span>Both Action Stage and Reflection Stage is implemented in the </span><code>user-simulator</code><span> directory.</span></p><p><span>This user simulator obeys our Multi-Round Conversational Recommendation Scenario, it can be easily customised to your own usage. </span></p><p><span>We have a user-friendly interface, you only need to change the parameter below in </span><code>run.py</code><span> to do all experiments.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="python" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span> = <span class="cm-variable">argparse</span>.<span class="cm-property">ArgumentParser</span>(<span class="cm-variable">description</span>=<span class="cm-string">"Run conversational recommendation."</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-mt'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'mt'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'MAX_TURN'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-playby'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'playby'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'playby'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># options include:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># AO: (Ask Only and recommend by probability)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># RO: (Recommend Only)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># policy: (action decided by our policy network)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-fmCommand'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'fmCommand'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'fmCommand'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># the command used for FM, check out /EAR/lastfm/FM/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-optim'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'optim'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'optimizer'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># the optimizer for policy network</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-lr'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'lr'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'lr'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># learning rate of policy network</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-decay'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'decay'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'decay'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># weight decay</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-TopKTaxo'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'TopKTaxo'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'TopKTaxo'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># how many 2-layer feature will represent a big feature. Only Yelp dataset use this param, lastFM have no effect.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-gamma'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'gamma'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'gamma'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># gamma of training policy network</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-trick'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'trick'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'trick'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># whether use normalization in training policy network</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-startFrom'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'startFrom'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'startFrom'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># startFrom which user-item interaction pair</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-endAt'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'endAt'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'endAt'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># endAt which user-item interaction pair</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-strategy'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'strategy'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'strategy'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># strategy to choose question to ask, only have effect</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-eval'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'eval'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'eval'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># whether current run is for evaluation</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-mini'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'mini'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'mini'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># means `mini`-batch update the FM</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-alwaysupdate'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'alwaysupdate'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'alwaysupdate'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># means always mini-batch update the FM, alternative is that only do the update for 1 time in a session.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># we leave this exploration tof follower of our work.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-initeval'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'initeval'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'initeval'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># whether do the evaluation for the `init`ial version of policy network (directly after pre-train)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-upoptim'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'upoptim'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'upoptim'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># optimizer for reflection stafe</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-upcount'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'upcount'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'upcount'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># how many times to do reflection</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-upreg'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">float</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'upreg'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'upreg'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># regularization term in</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-code'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'code'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'code'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># We use it to give each run a unique identifier.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-purpose'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'purpose'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'purpose'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># options: pretrain, others</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-mod'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">str</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'mod'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'mod'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># options: CRM, EAR</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">parser</span>.<span class="cm-property">add_argument</span>(<span class="cm-string">'-mask'</span>, <span class="cm-builtin">type</span>=<span class="cm-builtin">int</span>, <span class="cm-variable">dest</span>=<span class="cm-string">'mask'</span>, <span class="cm-builtin">help</span>=<span class="cm-string">'mask'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># use for ablation study, 1, 2, 3, 4 represent our four segments, {ent, sim, his, len}</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 1166px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1166px;"></div></div></div></pre><h3><a name="41-action-stage-training-and-evaluation" class="md-header-anchor"></a><span>4.1 Action Stage Training and Evaluation</span></h3><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cd</span> ~/EAR/yelp/lib/user-simulator</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Training</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">1</span> python run.py <span class="cm-attribute">-mt</span> <span class="cm-number">15</span> <span class="cm-attribute">-playby</span> policy <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-fmCommand</span> <span class="cm-number">8</span> <span class="cm-attribute">-upoptim</span> SGD &nbsp;<span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-TopKTaxo</span> <span class="cm-number">3</span> <span class="cm-attribute">-gamma</span> <span class="cm-number">0</span> <span class="cm-attribute">-strategy</span> maxent <span class="cm-attribute">-startFrom</span> <span class="cm-number">0</span> <span class="cm-attribute">-endAt</span> <span class="cm-number">20000</span> <span class="cm-attribute">-eval</span> <span class="cm-number">0</span> <span class="cm-attribute">-initeval</span> <span class="cm-number">0</span> <span class="cm-attribute">-trick</span> <span class="cm-number">0</span> <span class="cm-attribute">-mini</span> <span class="cm-number">0</span> <span class="cm-attribute">-alwaysupdate</span> <span class="cm-number">0</span> <span class="cm-attribute">-upcount</span> <span class="cm-number">0</span> <span class="cm-attribute">-upreg</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-code</span> stable <span class="cm-attribute">-mask</span> <span class="cm-number">0</span> <span class="cm-attribute">-purpose</span> train <span class="cm-attribute">-mod</span> ear</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Evaluation</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">2</span> python run.py <span class="cm-attribute">-mt</span> <span class="cm-number">15</span> <span class="cm-attribute">-playby</span> policy <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-fmCommand</span> <span class="cm-number">8</span> <span class="cm-attribute">-upoptim</span> SGD &nbsp;<span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-TopKTaxo</span> <span class="cm-number">3</span> <span class="cm-attribute">-gamma</span> <span class="cm-number">0</span>.7 <span class="cm-attribute">-strategy</span> maxent <span class="cm-attribute">-startFrom</span> <span class="cm-number">0</span> <span class="cm-attribute">-endAt</span> <span class="cm-number">20000</span> <span class="cm-attribute">-eval</span> <span class="cm-number">0</span> <span class="cm-attribute">-initeval</span> <span class="cm-number">0</span> <span class="cm-attribute">-trick</span> <span class="cm-number">0</span> <span class="cm-attribute">-mini</span> <span class="cm-number">1</span> <span class="cm-attribute">-alwaysupdate</span> <span class="cm-number">1</span> <span class="cm-attribute">-upcount</span> <span class="cm-number">4</span> <span class="cm-attribute">-upreg</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-code</span> stable <span class="cm-attribute">-mask</span> <span class="cm-number">0</span> <span class="cm-attribute">-purpose</span> train <span class="cm-attribute">-mod</span> ear</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><p><span>To see how the systems works:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cd</span> ~/EAR/statistics/</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">python conversation-evaluation.py</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 66px;"></div><div class="CodeMirror-gutters" style="display: none; height: 66px;"></div></div></div></pre><p><span>You will see the printed results in this format:</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">total epi: 11891</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 1, SR, 0.000</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 2, SR, 0.000</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 3, SR, 0.000</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 4, SR, 0.003</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 5, SR, 0.017</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 6, SR, 0.043</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 7, SR, 0.086</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 8, SR, 0.135</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 9, SR, 0.180</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 10, SR, 0.227</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 11, SR, 0.265</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 12, SR, 0.304</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 13, SR, 0.339</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 14, SR, 0.371</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">turn, 15, SR, 0.398</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">average: 12.632</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 374px;"></div><div class="CodeMirror-gutters" style="display: none; height: 374px;"></div></div></div></pre><p>&nbsp;</p><h3><a name="42-ablation-study" class="md-header-anchor"></a><span>4.2 Ablation Study</span></h3><ul><li><span>State Vector</span></li></ul><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">Change the <span class="cm-quote">`-mask`</span>  into <span class="cm-number">1</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">4</span>, <span class="cm-keyword">for</span> ablation study on segments of ent, sim, his, and len respectively</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">2</span> python run.py <span class="cm-attribute">-mt</span> <span class="cm-number">15</span> <span class="cm-attribute">-playby</span> policy <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-fmCommand</span> <span class="cm-number">8</span> <span class="cm-attribute">-upoptim</span> SGD &nbsp;<span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-TopKTaxo</span> <span class="cm-number">3</span> <span class="cm-attribute">-gamma</span> <span class="cm-number">0</span> <span class="cm-attribute">-strategy</span> maxent <span class="cm-attribute">-startFrom</span> <span class="cm-number">0</span> <span class="cm-attribute">-endAt</span> <span class="cm-number">20000</span> <span class="cm-attribute">-eval</span> <span class="cm-number">1</span> <span class="cm-attribute">-initeval</span> <span class="cm-number">0</span> <span class="cm-attribute">-trick</span> <span class="cm-number">0</span> <span class="cm-attribute">-mini</span> <span class="cm-number">1</span> <span class="cm-attribute">-alwaysupdate</span> <span class="cm-number">1</span> <span class="cm-attribute">-upcount</span> <span class="cm-number">4</span> <span class="cm-attribute">-upreg</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-code</span> stable <span class="cm-attribute">-mask</span> <span class="cm-number">1</span> <span class="cm-attribute">-purpose</span> train <span class="cm-attribute">-mod</span> ear</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">0</span> python run.py <span class="cm-attribute">-mt</span> <span class="cm-number">15</span> <span class="cm-attribute">-playby</span> policy <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-fmCommand</span> <span class="cm-number">8</span> <span class="cm-attribute">-upoptim</span> SGD &nbsp;<span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-TopKTaxo</span> <span class="cm-number">3</span> <span class="cm-attribute">-gamma</span> <span class="cm-number">0</span> <span class="cm-attribute">-strategy</span> maxent <span class="cm-attribute">-startFrom</span> <span class="cm-number">0</span> <span class="cm-attribute">-endAt</span> <span class="cm-number">20000</span> <span class="cm-attribute">-eval</span> <span class="cm-number">1</span> <span class="cm-attribute">-initeval</span> <span class="cm-number">0</span> <span class="cm-attribute">-trick</span> <span class="cm-number">0</span> <span class="cm-attribute">-mini</span> <span class="cm-number">1</span> <span class="cm-attribute">-alwaysupdate</span> <span class="cm-number">1</span> <span class="cm-attribute">-upcount</span> <span class="cm-number">4</span> <span class="cm-attribute">-upreg</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-code</span> stable <span class="cm-attribute">-mask</span> <span class="cm-number">2</span> <span class="cm-attribute">-purpose</span> train <span class="cm-attribute">-mod</span> ear</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">1</span> python run.py <span class="cm-attribute">-mt</span> <span class="cm-number">15</span> <span class="cm-attribute">-playby</span> policy <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-fmCommand</span> <span class="cm-number">8</span> <span class="cm-attribute">-upoptim</span> SGD &nbsp;<span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-TopKTaxo</span> <span class="cm-number">3</span> <span class="cm-attribute">-gamma</span> <span class="cm-number">0</span> <span class="cm-attribute">-strategy</span> maxent <span class="cm-attribute">-startFrom</span> <span class="cm-number">0</span> <span class="cm-attribute">-endAt</span> <span class="cm-number">20000</span> <span class="cm-attribute">-eval</span> <span class="cm-number">1</span> <span class="cm-attribute">-initeval</span> <span class="cm-number">0</span> <span class="cm-attribute">-trick</span> <span class="cm-number">0</span> <span class="cm-attribute">-mini</span> <span class="cm-number">1</span> <span class="cm-attribute">-alwaysupdate</span> <span class="cm-number">1</span> <span class="cm-attribute">-upcount</span> <span class="cm-number">4</span> <span class="cm-attribute">-upreg</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-code</span> stable <span class="cm-attribute">-mask</span> <span class="cm-number">3</span> <span class="cm-attribute">-purpose</span> train <span class="cm-attribute">-mod</span> ear</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">2</span> python run.py <span class="cm-attribute">-mt</span> <span class="cm-number">15</span> <span class="cm-attribute">-playby</span> policy <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-fmCommand</span> <span class="cm-number">8</span> <span class="cm-attribute">-upoptim</span> SGD &nbsp;<span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-TopKTaxo</span> <span class="cm-number">3</span> <span class="cm-attribute">-gamma</span> <span class="cm-number">0</span> <span class="cm-attribute">-strategy</span> maxent <span class="cm-attribute">-startFrom</span> <span class="cm-number">0</span> <span class="cm-attribute">-endAt</span> <span class="cm-number">20000</span> <span class="cm-attribute">-eval</span> <span class="cm-number">1</span> <span class="cm-attribute">-initeval</span> <span class="cm-number">0</span> <span class="cm-attribute">-trick</span> <span class="cm-number">0</span> <span class="cm-attribute">-mini</span> <span class="cm-number">1</span> <span class="cm-attribute">-alwaysupdate</span> <span class="cm-number">1</span> <span class="cm-attribute">-upcount</span> <span class="cm-number">4</span> <span class="cm-attribute">-upreg</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-code</span> stable <span class="cm-attribute">-mask</span> <span class="cm-number">4</span> <span class="cm-attribute">-purpose</span> train <span class="cm-attribute">-mod</span> ear</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 484px;"></div><div class="CodeMirror-gutters" style="display: none; height: 484px;"></div></div></div></pre><ul><li><span>Reflection</span></li></ul><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">We simply need to change </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">1</span> python run.py <span class="cm-attribute">-mt</span> <span class="cm-number">15</span> <span class="cm-attribute">-playby</span> policy <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-fmCommand</span> <span class="cm-number">8</span> <span class="cm-attribute">-upoptim</span> SGD &nbsp;<span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-TopKTaxo</span> <span class="cm-number">3</span> <span class="cm-attribute">-gamma</span> <span class="cm-number">0</span> <span class="cm-attribute">-strategy</span> maxent <span class="cm-attribute">-startFrom</span> <span class="cm-number">0</span> <span class="cm-attribute">-endAt</span> <span class="cm-number">20000</span> <span class="cm-attribute">-eval</span> <span class="cm-number">1</span> <span class="cm-attribute">-initeval</span> <span class="cm-number">0</span> <span class="cm-attribute">-trick</span> <span class="cm-number">0</span> <span class="cm-attribute">-mini</span> <span class="cm-number">0</span> <span class="cm-attribute">-alwaysupdate</span> <span class="cm-number">0</span> <span class="cm-attribute">-upcount</span> <span class="cm-number">0</span> <span class="cm-attribute">-upreg</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-code</span> stable <span class="cm-attribute">-mask</span> <span class="cm-number">0</span> <span class="cm-attribute">-purpose</span> train <span class="cm-attribute">-mod</span> ear</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 132px;"></div><div class="CodeMirror-gutters" style="display: none; height: 132px;"></div></div></div></pre><p>&nbsp;</p><h3><a name="43-baselines" class="md-header-anchor"></a><span>4.3 Baselines</span></h3><p><span>All baselines can all be easily implemented in our user simulator. </span></p><ul><li><span>Max Entropy</span></li></ul><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">CUDA_VISIBLE_DEVICES=0 python run.py -mt 15 -playby AO -optim SGD -lr 0.001 -fmCommand 8 -upoptim SGD  -decay 0 -TopKTaxo 3 -gamma 0 -strategy maxent -startFrom 0 -endAt 20000 -eval 1 -initeval 0 -trick 0 -mini 1 -alwaysupdate 1 -upcount 4 -upreg 0.001 -code stable -mask 0 -purpose train -mod ear</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 88px;"></div><div class="CodeMirror-gutters" style="display: none; height: 88px;"></div></div></div></pre><ul><li><span>CRM</span></li></ul><p><span>The training and Evaluation of this model can also be done following a simple </span><code>mod</code><span> parameter.</span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="bash"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Training</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">1</span> python run.py <span class="cm-attribute">-mt</span> <span class="cm-number">15</span> <span class="cm-attribute">-playby</span> policy <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-fmCommand</span> <span class="cm-number">8</span> <span class="cm-attribute">-upoptim</span> SGD &nbsp;<span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-TopKTaxo</span> <span class="cm-number">3</span> <span class="cm-attribute">-gamma</span> <span class="cm-number">0</span> <span class="cm-attribute">-strategy</span> maxent <span class="cm-attribute">-startFrom</span> <span class="cm-number">0</span> <span class="cm-attribute">-endAt</span> <span class="cm-number">20000</span> <span class="cm-attribute">-eval</span> <span class="cm-number">0</span> <span class="cm-attribute">-initeval</span> <span class="cm-number">0</span> <span class="cm-attribute">-trick</span> <span class="cm-number">0</span> <span class="cm-attribute">-mini</span> <span class="cm-number">0</span> <span class="cm-attribute">-alwaysupdate</span> <span class="cm-number">0</span> <span class="cm-attribute">-upcount</span> <span class="cm-number">0</span> <span class="cm-attribute">-upreg</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-code</span> stable <span class="cm-attribute">-mask</span> <span class="cm-number">0</span> <span class="cm-attribute">-purpose</span> train <span class="cm-attribute">-mod</span> crm</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Evaluation</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">CUDA_VISIBLE_DEVICES</span><span class="cm-operator">=</span><span class="cm-number">0</span> python run.py <span class="cm-attribute">-mt</span> <span class="cm-number">15</span> <span class="cm-attribute">-playby</span> policy <span class="cm-attribute">-optim</span> SGD <span class="cm-attribute">-lr</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-fmCommand</span> <span class="cm-number">8</span> <span class="cm-attribute">-upoptim</span> SGD &nbsp;<span class="cm-attribute">-decay</span> <span class="cm-number">0</span> <span class="cm-attribute">-TopKTaxo</span> <span class="cm-number">3</span> <span class="cm-attribute">-gamma</span> <span class="cm-number">0</span> <span class="cm-attribute">-strategy</span> maxent <span class="cm-attribute">-startFrom</span> <span class="cm-number">0</span> <span class="cm-attribute">-endAt</span> <span class="cm-number">20000</span> <span class="cm-attribute">-eval</span> <span class="cm-number">1</span> <span class="cm-attribute">-initeval</span> <span class="cm-number">0</span> <span class="cm-attribute">-trick</span> <span class="cm-number">0</span> <span class="cm-attribute">-mini</span> <span class="cm-number">1</span> <span class="cm-attribute">-alwaysupdate</span> <span class="cm-number">1</span> <span class="cm-attribute">-upcount</span> <span class="cm-number">4</span> <span class="cm-attribute">-upreg</span> <span class="cm-number">0</span>.001 <span class="cm-attribute">-code</span> stable <span class="cm-attribute">-mask</span> <span class="cm-number">0</span> <span class="cm-attribute">-purpose</span> train <span class="cm-attribute">-mod</span> crm</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 242px;"></div><div class="CodeMirror-gutters" style="display: none; height: 242px;"></div></div></div></pre><ul><li><span>Abs-Greedy</span></li></ul><p><span>Abs-Greedy Algorithm can be easily realized through our system. It is equivalent to Recommending Only option plus Update mechanism. </span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang=""><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">CUDA_VISIBLE_DEVICES=0 python run.py -mt 15 -playby RO -optim SGD -lr 0.001 -fmCommand 8 -upoptim SGD  -decay 0 -TopKTaxo 3 -gamma 0 -strategy maxent -startFrom 0 -endAt 20000 -eval 1 -initeval 0 -trick 0 -mini 1 -alwaysupdate 1 -upcount 4 -upreg 0.001 -code stable -mask 0 -purpose train -mod ear</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 88px;"></div><div class="CodeMirror-gutters" style="display: none; height: 88px;"></div></div></div></pre><p>&nbsp;</p><h2><a name="5-licence-and-patent" class="md-header-anchor"></a><span>5. Licence and Patent</span></h2><p><strong><span>TODO: Yisong</span></strong></p></div>
</body>
</html>